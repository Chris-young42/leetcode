/**
 * N çš‡åé—®é¢˜ï¼š
 * åœ¨ nÃ—n çš„æ£‹ç›˜ä¸Šæ”¾ç½® n ä¸ªçš‡åï¼Œä½¿å¾—å¥¹ä»¬å½¼æ­¤ä¸æ”»å‡»ã€‚
 * çš‡åæ”»å‡»æ–¹å¼ï¼šåŒè¡Œã€åŒåˆ—ã€åŒä¸»å¯¹è§’çº¿ã€å‰¯å¯¹è§’çº¿ã€‚
 * é¢˜ç›®è¦æ±‚è¿”å›æ‰€æœ‰åˆæ³•çš„æ”¾ç½®æ–¹æ¡ˆï¼Œæ¯ä¸ªæ–¹æ¡ˆç”¨å­—ç¬¦ä¸²æ•°ç»„è¡¨ç¤ºæ£‹ç›˜ã€‚
 *
 * @param {number} n - æ£‹ç›˜çš„å¤§å°ï¼Œä¹Ÿæ˜¯çš‡åçš„æ•°é‡
 * @return {string[][]} - æ‰€æœ‰è§£çš„é›†åˆ
 */
var solveNQueens = function (n) {
  // å­˜æ”¾æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è§£
  const ans = [];

  // queens[i] = j è¡¨ç¤ºï¼šç¬¬ i è¡Œçš„çš‡åæ”¾åœ¨ç¬¬ j åˆ—
  const queens = Array(n).fill(0);

  // col[j] è¡¨ç¤ºåˆ— j æ˜¯å¦å·²ç»æœ‰çš‡å
  const col = Array(n).fill(false);

  // diag1[k] è¡¨ç¤ºä¸»å¯¹è§’çº¿æ˜¯å¦æœ‰çš‡åï¼ˆä¸»å¯¹è§’çº¿æ–¹å‘ â†˜ï¼‰
  // ä¸»å¯¹è§’çº¿ç´¢å¼•è§„å¾‹ï¼šr + cï¼ˆè¡Œåˆ—ä¹‹å’Œç›¸ç­‰çš„ç‚¹åœ¨åŒä¸€ä¸»å¯¹è§’çº¿ä¸Šï¼‰
  const diag1 = Array(n * 2 - 1).fill(false);

  // diag2[k] è¡¨ç¤ºå‰¯å¯¹è§’çº¿æ˜¯å¦æœ‰çš‡åï¼ˆå‰¯å¯¹è§’çº¿æ–¹å‘ â†™ï¼‰
  // å‰¯å¯¹è§’çº¿ç´¢å¼•è§„å¾‹ï¼šr - c + (n - 1)
  // å› ä¸º r - c å¯èƒ½ä¸ºè´Ÿæ•°ï¼Œæ‰€ä»¥åŠ  (n - 1) åšåç§»
  const diag2 = Array(n * 2 - 1).fill(false);

  /**
   * æ·±åº¦ä¼˜å…ˆæœç´¢ + å›æº¯
   * @param {number} r - å½“å‰æ­£åœ¨å¤„ç†çš„è¡Œå·
   */
  function dfs(r) {
    // âœ… é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼šå·²ç»æˆåŠŸæ”¾ç½®äº† n è¡Œçš‡å
    if (r === n) {
      // å°† queens æ•°ç»„è½¬ä¸ºæ£‹ç›˜è¡¨ç¤º
      // ä¾‹å¦‚ queens = [1, 3, 0, 2] è½¬æ¢ä¸ºï¼š
      // [".Q..", "...Q", "Q...", "..Q."]
      const board = queens.map(
        (c) => ".".repeat(c) + "Q" + ".".repeat(n - 1 - c)
      );
      ans.push(board);
      return;
    }

    // ğŸ§­ éå†å½“å‰è¡Œçš„æ¯ä¸€åˆ—ï¼Œå°è¯•æ”¾çš‡å
    for (let c = 0; c < n; c++) {
      // å‰¯å¯¹è§’çº¿çš„ç´¢å¼•
      const rc = r - c + n - 1;

      // âš”ï¸ æ£€æŸ¥å½“å‰ä½ç½®æ˜¯å¦å†²çª              
      // 1. è¯¥åˆ—ä¸èƒ½æœ‰çš‡å
      // 2. ä¸»å¯¹è§’çº¿ä¸èƒ½æœ‰çš‡å
      // 3. å‰¯å¯¹è§’çº¿ä¸èƒ½æœ‰çš‡å
      if (!col[c] && !diag1[r + c] && !diag2[rc]) {
        // âœ… å¯ä»¥æ”¾ç½®çš‡å

        // è®°å½•çš‡åçš„ä½ç½®
        queens[r] = c;

        // ğŸš© æ ‡è®°å½“å‰åˆ—å’Œä¸¤æ¡å¯¹è§’çº¿
        col[c] = true;
        diag1[r + c] = true;
        diag2[rc] = true;

        // é€’å½’å¤„ç†ä¸‹ä¸€è¡Œ
        dfs(r + 1);

        // ğŸŒ€ å›æº¯ï¼šæ’¤é”€æ ‡è®°ï¼Œå°è¯•å…¶ä»–åˆ—
        col[c] = false;
        diag1[r + c] = false;
        diag2[rc] = false;
      }
    }
  }

  // ä»ç¬¬ 0 è¡Œå¼€å§‹æ”¾ç½®çš‡å
  dfs(0);

  // è¿”å›æ‰€æœ‰å¯è¡Œçš„è§£
  return ans;
};
